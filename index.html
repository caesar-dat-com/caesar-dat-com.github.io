<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />

  <title>C√©sar Reyes ¬∑ Perfil</title>
  <meta name="description" content="Sitio personal de C√©sar Reyes: perfil, experiencia, proyectos, stack y contacto." />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=VT323&display=swap"
    rel="stylesheet" />

  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      --colors-bg--100: #0e0b10;
      --colors-bg--300: #1e181e;
      --colors-bg--500: #191a1e;

      --colors-primary--200: #f4908b;
      --colors-primary--300: #ea6f69;
      --colors-primary--500: #e8615a;
      --colors-primary--600: #9c3230;

      --colors-secondary--500: #2be4ea;
      --colors-tertiary--500: #fed33f;

      --fonts-primary: "Rajdhani", system-ui, -apple-system, Segoe UI, Roboto,
        Arial, sans-serif;
      --fonts-secondary: "VT323", ui-monospace, SFMono-Regular, Menlo, Monaco,
        Consolas, "Liberation Mono", "Courier New", monospace;

      --ui-glow: 0 0 10px rgba(232, 97, 90, 0.35);
      --ui-glow-strong: 0 0 18px rgba(43, 228, 234, 0.35);
      --ui-glow-text: -9px -6px 40px currentColor;

      --ui-notch-amount: 1rem;
      --ui-notch-hypotenuse: 22.627416px;
      --ui-notch-path: polygon(0 0,
          100% 0,
          100% calc(100% - var(--ui-notch-amount) + 2px),
          calc(100% - var(--ui-notch-amount) + 2px) 100%,
          0 100%);

      --accent: var(--colors-secondary--500);
      --shadow: var(--colors-primary--500);

      height: 100%;
      margin: 0;
    }

    body {
      font-family: var(--fonts-primary);
      color: var(--colors-primary--500);
      background: radial-gradient(ellipse at 28% 12%,
          rgba(70, 22, 22, 0.95) 0%,
          transparent 60%),
        radial-gradient(ellipse at 72% 18%,
          rgba(43, 228, 234, 0.10) 0%,
          transparent 55%),
        linear-gradient(180deg, var(--colors-bg--500), var(--colors-bg--100));
      overflow: hidden;
      /* ‚úÖ evita ‚Äúromper‚Äù fondos por altura infinita */
    }

    /* Scanlines + grid */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(to bottom,
          rgba(255, 255, 255, 0.03),
          rgba(255, 255, 255, 0.03) 1px,
          transparent 1px,
          transparent 4px);
      opacity: 0.35;
      mix-blend-mode: overlay;
      z-index: 0;
    }

    body::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image: linear-gradient(rgba(43, 228, 234, 0.07) 1px,
          transparent 1px),
        linear-gradient(90deg, rgba(43, 228, 234, 0.07) 1px, transparent 1px);
      background-size: 42px 42px;
      opacity: 0.08;
      z-index: 0;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .skip {
      position: absolute;
      left: -9999px;
      top: 12px;
      padding: 10px 12px;
      background: rgba(25, 26, 30, 0.95);
      border: 1px solid var(--colors-secondary--500);
      color: var(--colors-secondary--500);
      font-family: var(--fonts-secondary);
      z-index: 9999;
    }

    .skip:focus {
      left: 12px;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
        scroll-behavior: auto !important;
      }
    }

    /* ========== App shell (altura fija + scroll interno) ========== */
    .app-skeleton {
      position: relative;
      z-index: 1;
      width: min(1180px, 100%);
      margin: 0 auto;
      padding: 16px 14px 16px;
      height: 100dvh;
      /* ‚úÖ */
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .app-header {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      padding: 14px 10px 12px;
      flex: 0 0 auto;
    }

    .app-header::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -4px;
      width: 100%;
      height: 2px;
      background: var(--colors-primary--500);
      box-shadow: var(--ui-glow);
      opacity: 0.9;
    }

    .brand {
      display: inline-flex;
      align-items: baseline;
      gap: 10px;
      padding: 6px 8px;
    }

    .brand__title {
      font-family: var(--fonts-secondary);
      font-size: 1.55rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      text-shadow: var(--ui-glow-text);
      color: var(--colors-secondary--500);
      white-space: nowrap;
    }

    .brand__tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 3px 10px;
      border: 1px solid var(--colors-tertiary--500);
      color: var(--colors-tertiary--500);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      clip-path: var(--ui-notch-path);
      background: rgba(25, 26, 30, 0.45);
    }

    .hint-pill {
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--colors-primary--200);
      padding: 6px 10px;
      border: 1px solid rgba(156, 50, 48, 0.9);
      background: rgba(25, 26, 30, 0.5);
      clip-path: var(--ui-notch-path);
      white-space: nowrap;
    }

    .app-container {
      flex: 1 1 auto;
      min-height: 0;
      /* ‚úÖ crucial para scroll interno */
      display: grid;
      grid-template-columns: 280px 1fr 320px;
      gap: 14px;
      align-items: stretch;
    }

    .app-container>aside,
    .app-container>main {
      min-height: 0;
      /* ‚úÖ */
    }

    @media (max-width: 980px) {
      body {
        overflow: auto;
      }

      .app-skeleton {
        height: auto;
      }

      .app-container {
        grid-template-columns: 1fr;
        min-height: auto;
      }
    }

    /* ========== UI blocks ========== */
    .pad {
      background: rgba(30, 24, 30, 0.92);
      border: 2px solid var(--colors-primary--600);
      clip-path: var(--ui-notch-path);
      box-shadow: var(--ui-glow);
      position: relative;
      height: 100%;
    }

    .pad::before {
      content: "";
      position: absolute;
      right: -6px;
      bottom: 5px;
      width: var(--ui-notch-hypotenuse);
      height: 3px;
      transform: rotate(-45deg);
      background: var(--colors-primary--600);
      z-index: 2;
    }

    .pad__body {
      padding: 16px 16px calc(16px + var(--ui-notch-amount));
      height: 100%;
    }

    .pad__scroll {
      overflow: auto;
      /* ‚úÖ scroll interno */
    }

    .section-title {
      margin: 0 0 6px;
      font-family: var(--fonts-secondary);
      letter-spacing: 0.09em;
      text-transform: uppercase;
      color: var(--colors-secondary--500);
      text-shadow: 0 0 14px rgba(43, 228, 234, 0.25);
    }

    .muted {
      color: var(--colors-primary--200);
      margin: 0;
    }

    .divider {
      height: 1px;
      background: rgba(232, 97, 90, 0.35);
      box-shadow: var(--ui-glow);
      margin: 12px 0;
      opacity: 0.8;
    }

    /* ========== Left rail nav ========== */
    .nav-section__header {
      background: rgba(25, 26, 30, 0.7);
      border: 1px solid rgba(93, 35, 34, 0.95);
      border-radius: 3px;
      padding: 10px 12px;
      margin-bottom: 10px;
    }

    .nav-section__title {
      margin: 0;
      color: var(--colors-secondary--500);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .nav-rail {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 6px;
    }

    .nav-rail button {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 9px 10px;
      border: 1px solid transparent;
      border-radius: 3px;
      color: var(--colors-secondary--500);
      background: transparent;
      cursor: pointer;
      font: inherit;
      transition: background-color 0.2s, border-color 0.2s, transform 0.2s;
    }

    .nav-rail button:hover,
    .nav-rail button:focus-visible {
      background: rgba(25, 26, 30, 0.7);
      border-color: rgba(93, 35, 34, 0.95);
      transform: translateX(1px);
      outline: none;
    }

    .nav-rail button.is-active {
      background: rgba(57, 20, 25, 0.75);
      border-color: var(--colors-primary--600);
      color: var(--colors-tertiary--500);
    }

    .badge {
      border: 1.5px solid var(--colors-tertiary--500);
      border-radius: 3px;
      color: var(--colors-tertiary--500);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      padding: 2px 6px;
      font-size: 0.95rem;
    }

    .form-control {
      background: rgba(25, 26, 30, 0.55);
      border: 1px solid var(--colors-primary--600);
      clip-path: var(--ui-notch-path);
      padding: 8px;
      position: relative;
    }

    .form-control::before {
      content: "";
      position: absolute;
      right: -6px;
      bottom: 5px;
      width: var(--ui-notch-hypotenuse);
      height: 3px;
      transform: rotate(-45deg);
      background: var(--colors-primary--600);
    }

    .form-control input {
      width: 100%;
      border: 0;
      outline: none;
      background: transparent;
      color: var(--colors-primary--200);
      font-family: var(--fonts-primary);
      font-size: 1rem;
      letter-spacing: 0.04em;
    }

    /* ========== Center view router ========== */
    main .pad__body {
      padding: 0;
      overflow: hidden;
    }

    #stage {
      position: relative;
      height: 100%;
      overflow: auto;
      /* ‚úÖ */
      padding: 16px 16px calc(16px + var(--ui-notch-amount));
    }

    .page {
      display: none;
    }

    .page.is-active {
      display: block;
      view-transition-name: page;
    }

    #stage::before {
      content: "";
      position: absolute;
      inset: -2px;
      pointer-events: none;
      opacity: 0;
      background: repeating-linear-gradient(to bottom,
          rgba(43, 228, 234, 0.18),
          rgba(43, 228, 234, 0.18) 1px,
          transparent 1px,
          transparent 6px);
      mix-blend-mode: screen;
      filter: blur(0.2px);
    }

    #stage.is-glitch::before {
      animation: stage-glitch 420ms steps(2) both;
      opacity: 0.6;
    }

    @keyframes stage-glitch {
      0% {
        transform: translate(0, 0);
        clip-path: inset(0 0 0 0);
      }

      25% {
        transform: translate(2px, -1px);
        clip-path: inset(8% 0 62% 0);
      }

      55% {
        transform: translate(-2px, 1px);
        clip-path: inset(38% 0 34% 0);
      }

      100% {
        transform: translate(0, 0);
        clip-path: inset(0 0 0 0);
      }
    }

    @supports (view-transition-name: page) {
      ::view-transition-old(page) {
        animation: vt-out 220ms ease both;
        filter: saturate(120%) blur(1px);
        opacity: 0.85;
      }

      ::view-transition-new(page) {
        animation: vt-in 260ms ease both, vt-glitch 520ms steps(2) both;
        filter: saturate(120%);
      }

      @keyframes vt-in {
        from {
          opacity: 0;
          transform: translateY(10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes vt-out {
        from {
          opacity: 1;
          transform: translateY(0);
        }

        to {
          opacity: 0;
          transform: translateY(-8px);
        }
      }

      @keyframes vt-glitch {
        0% {
          clip-path: inset(0 0 0 0);
        }

        20% {
          clip-path: inset(10% 0 60% 0);
          transform: translateX(-1px);
        }

        45% {
          clip-path: inset(44% 0 35% 0);
          transform: translateX(1px);
        }

        70% {
          clip-path: inset(65% 0 15% 0);
          transform: translateX(-1px);
        }

        100% {
          clip-path: inset(0 0 0 0);
          transform: translateX(0);
        }
      }
    }

    /* ========== Cards & lists ========== */
    .grid-2 {
      display: grid;
      gap: 12px;
      grid-template-columns: 1fr;
    }

    @media (min-width: 760px) {
      .grid-2 {
        grid-template-columns: 1fr 1fr;
      }
    }

    .cards {
      display: grid;
      gap: 12px;
    }

    .item {
      background: rgba(25, 26, 30, 0.55);
      border: 1px solid rgba(156, 50, 48, 0.9);
      clip-path: var(--ui-notch-path);
      padding: 12px;
      position: relative;
    }

    .item::before {
      content: "";
      position: absolute;
      right: -6px;
      bottom: 4px;
      width: var(--ui-notch-hypotenuse);
      height: 3px;
      transform: rotate(-45deg);
      background: rgba(156, 50, 48, 0.9);
    }

    .item h4 {
      margin: 0 0 6px;
      color: var(--colors-secondary--500);
      letter-spacing: 0.02em;
    }

    .item p {
      margin: 0;
      color: var(--colors-primary--200);
    }

    .detail-list {
      margin: 10px 0 0;
      padding-left: 18px;
      color: var(--colors-primary--200);
    }

    .detail-list li+li {
      margin-top: 6px;
    }

    /* ========== Chips ========== */
    .chip-list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .chip {
      padding: 8px 14px;
      border-radius: 2px;
      background: rgba(25, 26, 30, 0.65);
      border: 1px solid rgba(156, 50, 48, 0.9);
      color: var(--colors-secondary--500);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      text-transform: uppercase;
      clip-path: var(--ui-notch-path);
      position: relative;
    }

    .chip::before {
      content: "";
      position: absolute;
      right: -6px;
      bottom: 4px;
      width: var(--ui-notch-hypotenuse);
      height: 3px;
      transform: rotate(-45deg);
      background: rgba(156, 50, 48, 0.9);
    }

    /* ========== Hero ========== */
    .hero-title {
      margin: 0 0 8px;
      font-size: clamp(1.8rem, 3.2vw, 2.6rem);
      letter-spacing: 0.02em;
      color: var(--colors-secondary--500);
      text-shadow: var(--ui-glow-text);
    }

    .hero-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 18px;
      color: var(--colors-primary--200);
      margin: 0;
    }

    .hero-meta span {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border: 1px solid rgba(93, 35, 34, 0.95);
      background: rgba(25, 26, 30, 0.45);
      border-radius: 3px;
    }

    /* ========== Cyber button + Popover ========== */
    .cyber-btn {
      --corner: 12px;
      --border: 1px;
      --clip: polygon(0 0,
          100% 0,
          100% calc(100% - var(--corner)),
          calc(100% - var(--corner)) 100%,
          0% 100%);
      width: 100%;
      text-align: left;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.6rem 0.6rem;
      border: 0;
      background: transparent;
      position: relative;
      color: var(--accent);
      cursor: pointer;
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
    }

    .cyber-btn * {
      pointer-events: none;
    }

    .cyber-btn kbd {
      color: var(--colors-bg--300);
      font-weight: 700;
      width: 22px;
      aspect-ratio: 1;
      font-size: 9px;
      border-radius: 50%;
      background: var(--accent);
      display: inline-grid;
      place-items: center;
    }

    .backdrop {
      position: absolute;
      z-index: -1;
      inset: 0;
      background: rgba(0, 0, 0, 0.25);
      clip-path: var(--clip);
      pointer-events: none;
      box-shadow: var(--ui-glow-strong);
    }

    .backdrop::before {
      content: "";
      position: absolute;
      inset: 0;
      background: var(--accent);
      border: var(--border) solid transparent;
      clip-path: var(--clip);
      mask: linear-gradient(#0000 0% 100%), linear-gradient(#fff 0% 100%);
      mask-clip: padding-box, border-box;
      mask-repeat: no-repeat;
      mask-composite: intersect;
      opacity: 0.8;
    }

    .corner {
      position: absolute;
      bottom: 0;
      right: 0;
      height: var(--corner);
      width: var(--corner);
    }

    .corner::after {
      content: "";
      height: calc(var(--border) * 2);
      width: 200%;
      position: absolute;
      top: 50%;
      left: 50%;
      translate: -50% -50%;
      transform: rotate(135deg);
      background: var(--accent);
    }

    .cyber-btn .glitch {
      display: none;
      position: absolute;
      inset: 0;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.6rem 0.6rem;
      color: var(--accent);
      text-shadow: 0 1px var(--shadow);
    }

    .cyber-btn:is(:hover, :focus-visible) .glitch {
      display: flex;
      animation: glitch 2s infinite;
      outline: none;
    }

    .letters {
      display: inline-flex;
      gap: 1px;
    }

    .letters span:nth-of-type(2),
    .letters span:nth-of-type(5) {
      transform: scale(1, -1);
    }

    .letters span:nth-of-type(3),
    .letters span:nth-of-type(6),
    .letters span:nth-of-type(7) {
      transform: scale(-1, -1);
    }

    @keyframes glitch {
      0% {
        clip-path: polygon(0 2%, 100% 2%, 100% 95%, 95% 95%, 95% 90%, 85% 90%, 85% 95%, 8% 95%, 0 70%);
      }

      8% {
        clip-path: polygon(0 78%, 100% 78%, 100% 100%, 95% 100%, 95% 90%, 85% 90%, 85% 100%, 8% 100%, 0 78%);
        transform: translate(-2px, 0);
      }

      10% {
        clip-path: polygon(0 44%, 100% 44%, 100% 54%, 95% 54%, 85% 54%, 8% 54%, 0 54%);
        transform: translate(2px, 0);
      }

      45% {
        clip-path: polygon(0 40%, 100% 40%, 100% 85%, 95% 85%, 85% 85%, 8% 85%, 0 70%);
        transform: translate(-2px, 0);
      }

      100% {
        clip-path: polygon(0 0, 100% 0, 100% 0, 95% 0, 85% 0, 8% 0, 0 0);
        transform: translate(0, 0);
      }
    }

    .modal {
      --corner: 12px;
      --border: 2px;
      --clip: polygon(0 0,
          100% 0,
          100% calc(100% - var(--corner)),
          calc(100% - var(--corner)) 100%,
          0% 100%);

      color: var(--accent);
      width: clamp(340px, 55vw, 560px);
      border: 0;
      padding: 0;
      overflow: visible;
      background: transparent;
      font-family: var(--fonts-secondary);
    }

    .modal::backdrop {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(6px);
    }

    .modal__body {
      backdrop-filter: saturate(180%) blur(8px);
      background: rgba(0, 0, 0, 0.25);
      border: var(--border) solid rgba(43, 228, 234, 0.65);
      clip-path: var(--clip);
    }

    .body__content {
      padding: 1rem;
      position: relative;
    }

    .modal h2 {
      margin: 0 0 0.75rem 0;
      text-transform: uppercase;
      position: relative;
      font-size: 1.25rem;
    }

    .modal h2::after {
      content: "";
      height: var(--border);
      top: 100%;
      left: 0;
      right: 0;
      background: var(--accent);
      position: absolute;
      opacity: 0.85;
    }

    .modal p {
      margin: 0.5rem 0 0;
      color: color-mix(in oklch, var(--accent), white 35%);
      letter-spacing: 0.04em;
      font-family: var(--fonts-primary);
    }

    .modal__actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-end;
      padding: 1rem 0 0;
    }

    .action-btn {
      border: 1px solid rgba(43, 228, 234, 0.65);
      background: rgba(0, 0, 0, 0.25);
      color: var(--accent);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      text-transform: uppercase;
      padding: 10px 12px;
      cursor: pointer;
      clip-path: var(--ui-notch-path);
    }

    .action-btn:hover,
    .action-btn:focus-visible {
      outline: none;
      background: rgba(43, 228, 234, 0.08);
    }

    .action-btn--danger {
      border-color: rgba(232, 97, 90, 0.7);
      color: var(--colors-primary--200);
    }

    /* Toast */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(25, 26, 30, 0.92);
      border: 1px solid var(--colors-secondary--500);
      color: var(--colors-secondary--500);
      padding: 10px 12px;
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      clip-path: var(--ui-notch-path);
      box-shadow: var(--ui-glow-strong);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 9999;
    }

    .toast.is-on {
      opacity: 1;
      transform: translateX(-50%) translateY(-2px);
    }

    /* Memento Mori widget */
    .mm-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
    }

    .mm-title {
      margin: 0;
      font-family: var(--fonts-secondary);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--colors-tertiary--500);
    }

    .mm-sub {
      margin: 0;
      color: var(--colors-primary--200);
    }

    .mm-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .mm-stat {
      background: rgba(25, 26, 30, 0.55);
      border: 1px solid rgba(156, 50, 48, 0.9);
      clip-path: var(--ui-notch-path);
      padding: 10px;
    }

    .mm-stat b {
      color: var(--colors-secondary--500);
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
    }

    .mm-stat span {
      display: block;
      margin-top: 6px;
      color: var(--colors-primary--200);
    }

    .mm-canvas-wrap {
      margin-top: 12px;
      border: 1px solid rgba(43, 228, 234, 0.35);
      background: rgba(0, 0, 0, 0.18);
      clip-path: var(--ui-notch-path);
      padding: 10px;
    }

    .mm-legend {
      margin-top: 10px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      color: var(--colors-primary--200);
      font-family: var(--fonts-primary);
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 2px;
      display: inline-block;
      margin-right: 6px;
      border: 1px solid rgba(255, 255, 255, 0.12);
    }

    .dot--lived {
      background: var(--accent);
    }

    .dot--left {
      background: rgba(255, 255, 255, 0.12);
    }

    .dot--now {
      background: var(--colors-tertiary--500);
    }

    .mm-kv {
      display: grid;
      gap: 10px;
      grid-template-columns: 1fr;
      margin-top: 12px;
    }

    .mm-kv .item {
      padding: 10px;
    }

    .mono {
      font-family: var(--fonts-secondary);
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    /* Tiny */
    code {
      color: var(--colors-tertiary--500);
      font-family: var(--fonts-secondary);
    }
  </style>
</head>

<body>
  <a class="skip" href="#main">Saltar al contenido</a>

  <div class="app-skeleton" id="top">
    <header class="app-header">
      <a class="brand" href="#top" aria-label="Inicio">
        <span class="brand__title">C√âSAR REYES</span>
        <span class="brand__tag">DATA ¬∑ IA ¬∑ AUTOMATION</span>
      </a>

      <span class="hint-pill">U: Actions ¬∑ 1‚Äì7: Secciones ¬∑ M: Memento</span>
    </header>

    <div class="app-container">
      <!-- Left rail -->
      <aside>
        <div class="pad">
          <div class="pad__body pad__scroll">
            <div class="nav-section">
              <div class="nav-section__header">
                <h2 class="nav-section__title">Secciones</h2>
              </div>

              <ul class="nav-rail" id="rail">
                <li>
                  <button type="button" data-go="about">
                    <span>Sobre m√≠</span><span class="badge">1</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="stack">
                    <span>Stack</span><span class="badge">2</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="experience">
                    <span>Experiencia</span><span class="badge">3</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="projects">
                    <span>Proyectos</span><span class="badge">4</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="education">
                    <span>Educaci√≥n</span><span class="badge">5</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="certs">
                    <span>Certificaciones</span><span class="badge">6</span>
                  </button>
                </li>
                <li>
                  <button type="button" data-go="contact">
                    <span>Contacto</span><span class="badge">7</span>
                  </button>
                </li>
              </ul>
            </div>

            <div class="divider"></div>

            <h3 class="section-title" style="font-size: 1.05rem">Buscar</h3>
            <p class="muted" style="margin-bottom: 10px">
              B√∫squeda en skills y certificaciones.
            </p>
            <div class="form-control">
              <input id="search" type="text" placeholder="python, power bi, QA, ..." autocomplete="off" />
            </div>

            <div class="divider"></div>

            <button class="cyber-btn" type="button" aria-label="Actions" popovertarget="actions"
              popovertargetaction="show" id="actions-btn">
              <span class="backdrop"><span class="corner"></span></span>
              <kbd>U</kbd>
              <span>Actions</span>

              <span class="glitch" aria-hidden="true">
                <span class="backdrop"><span class="corner"></span></span>
                <kbd>U</kbd>
                <span class="letters">
                  <span>A</span><span>c</span><span>t</span><span>i</span><span>o</span><span>n</span><span>s</span>
                </span>
              </span>
            </button>

            <div style="height: 10px"></div>

            <button class="cyber-btn" type="button" aria-label="Memento Mori" popovertarget="memento"
              popovertargetaction="show" id="memento-btn-left" style="color: var(--colors-tertiary--500)">
              <span class="backdrop" style="box-shadow: 0 0 18px rgba(254, 211, 63, 0.22)">
                <span class="corner"></span>
              </span>
              <kbd style="background: var(--colors-tertiary--500)">M</kbd>
              <span>Memento Mori</span>

              <span class="glitch" aria-hidden="true" style="color: var(--colors-tertiary--500)">
                <span class="backdrop" style="box-shadow: 0 0 18px rgba(254, 211, 63, 0.22)">
                  <span class="corner"></span>
                </span>
                <kbd style="background: var(--colors-tertiary--500)">M</kbd>
                <span class="letters">
                  <span>M</span><span>e</span><span>m</span><span>e</span><span>n</span><span>t</span><span>o</span>
                </span>
              </span>
            </button>
          </div>
        </div>
      </aside>

      <!-- Center -->
      <main id="main">
        <div class="pad">
          <div class="pad__body">
            <div id="stage">
              <!-- ABOUT -->
              <section class="page is-active" id="about" data-page>
                <h1 class="hero-title" id="name">Cargando‚Ä¶</h1>
                <p class="hero-meta">
                  <span>üíº <strong id="headline">‚Äî</strong></span>
                  <span>üìç <strong id="location">‚Äî</strong></span>
                  <span>‚ö° <strong id="focus">Automatizaci√≥n ¬∑ Datos ¬∑ IA</strong></span>
                </p>

                <div class="divider"></div>

                <p class="muted" id="summary" style="font-size: 1.05rem">
                  Cargando resumen‚Ä¶
                </p>

                <div class="divider"></div>

                <div class="grid-2">
                  <div class="item">
                    <h4>Enfoque actual</h4>
                    <p>
                      Ingenier√≠a en Datos e IA (UAO) + automatizaci√≥n de procesos y
                      mejora continua (experiencia industrial).
                    </p>
                  </div>
                  <div class="item">
                    <h4>Highlights</h4>
                    <ul class="detail-list">
                      <li>Implement√© un aplicativo low-code (~1300 usuarios).</li>
                      <li>1er lugar Rally Latinoamericano de Innovaci√≥n (UAO).</li>
                      <li>Ruta BI/Analytics (Power BI, DAX, Tableau, Looker, Excel).</li>
                    </ul>
                  </div>
                </div>
              </section>

              <!-- STACK -->
              <section class="page" id="stack" data-page>
                <h2 class="section-title">Stack</h2>
                <p class="muted">Skills (LinkedIn) + skills clave.</p>

                <div class="divider"></div>

                <div class="grid-2">
                  <div>
                    <h3 class="section-title" style="font-size: 1.05rem">
                      Skills (LinkedIn)
                    </h3>
                    <ul id="skills" class="chip-list" style="margin-top: 10px"></ul>
                    <p class="muted" id="skills-empty" style="display: none; margin-top: 10px">
                      No hay skills para mostrar.
                    </p>
                  </div>

                  <div>
                    <h3 class="section-title" style="font-size: 1.05rem">
                      Skills clave
                    </h3>
                    <ul class="chip-list" style="margin-top: 10px">
                      <li class="chip">Python</li>
                      <li class="chip">POO</li>
                      <li class="chip">SQL</li>
                      <li class="chip">Power BI</li>
                      <li class="chip">DAX</li>
                      <li class="chip">Tableau</li>
                      <li class="chip">Looker Studio</li>
                      <li class="chip">Excel</li>
                      <li class="chip">QA & testing</li>
                      <li class="chip">Git / GitHub</li>
                      <li class="chip">HTML / CSS</li>
                      <li class="chip">Low-code</li>
                    </ul>

                    <div class="divider"></div>

                    <div class="item">
                      <h4>Soft skills & idiomas</h4>
                      <p>
                        Trabajo en equipo ¬∑ Decisiones basadas en datos ¬∑ Adaptabilidad
                        y gesti√≥n del cambio ¬∑ Comunicaci√≥n clara y asertiva ¬∑ Proactividad
                        y aprendizaje continuo ¬∑ Atenci√≥n al detalle y enfoque en la calidad.
                      </p>
                      <p style="margin-top: 10px" class="muted">
                        <strong>Espa√±ol:</strong> nativo ¬∑ <strong>Ingl√©s:</strong> intermedio (B1‚ÄìB2)
                      </p>
                    </div>
                  </div>
                </div>
              </section>

              <!-- EXPERIENCE -->
              <section class="page" id="experience" data-page>
                <h2 class="section-title">Experiencia</h2>
                <p class="muted">Rol actual + trayectoria en planta.</p>

                <div class="divider"></div>

                <div class="cards">
                  <article class="item">
                    <h4>Supervisor ‚Äì Postob√≥n S.A. <span class="badge">Actual</span></h4>
                    <p class="muted">Cali, Colombia</p>
                    <ul class="detail-list">
                      <li>Supervisi√≥n de operaciones en planta, est√°ndares de calidad, productividad y seguridad.</li>
                      <li>Asignaci√≥n y seguimiento de tareas para continuidad de producci√≥n.</li>
                      <li>Reportes e indicadores con herramientas ofim√°ticas y sistemas internos.</li>
                      <li>Trabajo con Mantenimiento para reportar incidentes y proponer mejoras.</li>
                    </ul>
                  </article>

                  <article class="item">
                    <h4>T√©cnico ‚Äì Postob√≥n S.A.</h4>
                    <p class="muted">Cali, Colombia</p>
                    <ul class="detail-list">
                      <li>Soporte t√©cnico en l√≠neas de producci√≥n y equipos.</li>
                      <li>Registro de incidencias/intervenciones mejorando trazabilidad.</li>
                      <li>Colaboraci√≥n para reducir tiempos de parada y aumentar eficiencia.</li>
                    </ul>
                  </article>
                </div>
              </section>

              <!-- PROJECTS -->
              <section class="page" id="projects" data-page>
                <h2 class="section-title">Proyectos</h2>
                <p class="muted">Proyectos con impacto (operaci√≥n real + innovaci√≥n).</p>

                <div class="divider"></div>

                <div class="cards">
                  <article class="item">
                    <h4>Aplicativo low-code nacional ‚Äì Postob√≥n S.A.</h4>
                    <p class="muted">Control de personal y tareas de Mantenimiento ¬∑ <span class="badge">~1300
                        usuarios</span></p>
                    <ul class="detail-list">
                      <li>Dise√±o e implementaci√≥n para control de personal, asignaci√≥n y seguimiento.</li>
                      <li>Centralizaci√≥n de procesos manuales en flujo digital trazable.</li>
                    </ul>
                  </article>

                  <article class="item">
                    <h4>Rally Latinoamericano de Innovaci√≥n ‚Äì 1er lugar</h4>
                    <p class="muted">Categor√≠a Innovaci√≥n (UAO)</p>
                    <ul class="detail-list">
                      <li>Integrante del equipo ganador con soluci√≥n a reto real en tiempo limitado.</li>
                    </ul>
                  </article>

                  <article class="item">
                    <h4>Platzi Space Program ‚Äì Sat√©lite</h4>
                    <p class="muted">Programa intensivo</p>
                    <ul class="detail-list">
                      <li>Refuerzo de fundamentos de ingenier√≠a, trabajo en equipo y pensamiento sist√©mico.</li>
                    </ul>
                  </article>
                </div>
              </section>

              <!-- EDUCATION -->
              <section class="page" id="education" data-page>
                <h2 class="section-title">Educaci√≥n</h2>
                <p class="muted">Formaci√≥n base + especializaci√≥n en datos/IA.</p>

                <div class="divider"></div>

                <div class="cards">
                  <article class="item">
                    <h4>Ingenier√≠a en Datos e Inteligencia Artificial</h4>
                    <p class="muted">Universidad Aut√≥noma de Occidente (UAO) ¬∑ Cali, Colombia</p>
                    <p class="muted" style="margin-top: 8px">
                      Etapa final ¬∑ Incluye certificaci√≥n de ingl√©s (B1/B2).
                    </p>
                  </article>

                  <article class="item">
                    <h4>Tecnolog√≠a en Gesti√≥n de Sistemas Mecatr√≥nicos</h4>
                    <p class="muted">FCECEP ¬∑ Cali, Colombia</p>
                  </article>
                </div>
              </section>

              <!-- CERTS -->
              <section class="page" id="certs" data-page>
                <h2 class="section-title">Certificaciones</h2>
                <p class="muted">Cursos, certificaciones y formaci√≥n adicional.</p>

                <div class="divider"></div>

                <div class="grid-2">
                  <div class="item">
                    <h4>Certificaciones (LinkedIn)</h4>
                    <ul id="certifications" class="detail-list" style="margin-top: 10px"></ul>
                    <p class="muted" id="certs-empty" style="display: none; margin-top: 10px">
                      No hay certificaciones para mostrar.
                    </p>
                  </div>

                  <div class="item">
                    <h4>Formaci√≥n adicional</h4>
                    <p class="muted">
                      M√°s de 18 cursos completados como parte de una ruta integral en An√°lisis de Datos y Business
                      Intelligence, incluyendo Power BI, DAX, Tableau, Looker Studio, Excel avanzado, forecasting,
                      m√©tricas de negocio, storytelling, estad√≠stica aplicada.
                      Adem√°s de cursos de fundamentos de Python, circuitos electr√≥nicos, electricidad e ingl√©s t√©cnico
                      enfocado en tecnolog√≠a e innovaci√≥n.
                    </p>
                  </div>
                </div>
              </section>

              <!-- CONTACT -->
              <section class="page" id="contact" data-page>
                <h2 class="section-title">Contacto</h2>
                <p class="muted">
                  Email: <span id="email-text">cesar.cesarreyes25@gmail.com</span>
                </p>

                <div class="divider"></div>

                <div class="item">
                  <h4>Mensaje r√°pido</h4>
                  <p class="muted">
                    ‚ÄúHola C√©sar, vi tu perfil y me gustar√≠a hablar sobre‚Ä¶‚Äù
                  </p>
                </div>

                <div class="divider"></div>

                <p class="muted" style="text-align:center; opacity:.9;">
                  ¬© <span id="year"></span> C√©sar Reyes
                </p>
              </section>
            </div>
          </div>
        </div>
      </main>

      <!-- Right rail (Memento Mori aqu√≠) -->
      <aside>
        <div class="pad">
          <div class="pad__body pad__scroll">
            <h2 class="section-title">Snapshot</h2>
            <p class="muted" id="snapshot">Vista r√°pida. Se actualiza seg√∫n la secci√≥n.</p>

            <div class="divider"></div>

            <div class="item">
              <h4>Secci√≥n actual</h4>
              <p class="muted" id="current-section">Sobre m√≠</p>
            </div>

            <div class="divider"></div>

            <!-- MEMENTO MORI WIDGET -->
            <button class="item" id="mm-card" type="button" popovertarget="memento" popovertargetaction="show"
              style="width:100%; text-align:left; cursor:pointer;" aria-label="Abrir Memento Mori">
              <div class="mm-header">
                <h3 class="mm-title">Memento Mori</h3>
                <span class="badge">Semanas</span>
              </div>
              <p class="mm-sub" id="mm-sub">Cargando‚Ä¶</p>

              <div class="mm-stats">
                <div class="mm-stat">
                  <b>Vividas</b>
                  <span id="mm-lived">‚Äî</span>
                </div>
                <div class="mm-stat">
                  <b>Restantes</b>
                  <span id="mm-left">‚Äî</span>
                </div>
              </div>

              <div class="mm-canvas-wrap">
                <canvas id="mm-canvas" width="280" height="220" aria-label="Calendario de vida por semanas"></canvas>
                <div class="mm-legend">
                  <span><i class="dot dot--lived"></i>vividas</span>
                  <span><i class="dot dot--left"></i>restantes</span>
                  <span><i class="dot dot--now"></i>semana actual</span>
                </div>
              </div>
            </button>

            <div class="divider"></div>

            <p class="muted" style="margin: 0">
              <span class="mono" style="color: var(--colors-tertiary--500);">NETWIRE_ID</span>
              <span style="opacity: 0.8">:</span>
              <span id="seed" class="muted"></span>
            </p>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <!-- Popover: Quick Actions -->
  <div class="modal" popover="auto" id="actions">
    <section class="modal__body">
      <div class="body__content">
        <h2><span>Quick Actions</span></h2>
        <p>Links y utilidades.</p>

        <div class="divider"></div>

        <div class="modal__actions">
          <button class="action-btn" data-action="linkedin" type="button">Open LinkedIn</button>
          <button class="action-btn" data-action="github" type="button">Open GitHub</button>
          <button class="action-btn" data-action="copy" type="button">Copy email</button>
          <button class="action-btn action-btn--danger" data-action="close" type="button">Close (Esc)</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Popover: Memento Mori -->
  <div class="modal" popover="auto" id="memento">
    <section class="modal__body">
      <div class="body__content">
        <h2><span>Memento Mori</span></h2>
        <p id="mm-modal-sub">Tiempo restante en semana / d√≠a / vida (estimado).</p>

        <div class="divider"></div>

        <div class="mm-kv">
          <div class="item">
            <h4>Fin del d√≠a</h4>
            <p class="muted mono" id="t-day">‚Äî</p>
          </div>
          <div class="item">
            <h4>Fin de la semana</h4>
            <p class="muted mono" id="t-week">‚Äî</p>
          </div>
          <div class="item">
            <h4>Vida (estimado)</h4>
            <p class="muted mono" id="t-life">‚Äî</p>
            <p class="muted" id="life-date" style="margin-top:8px; opacity:.9;"></p>
          </div>
          <div class="item">
            <h4>Semanas</h4>
            <p class="muted">
              <span class="mono">Vividas:</span> <span id="mm-lived-2">‚Äî</span><br />
              <span class="mono">Restantes:</span> <span id="mm-left-2">‚Äî</span><br />
              <span class="mono">Total:</span> <span id="mm-total-2">‚Äî</span>
            </p>
          </div>
        </div>

        <div class="modal__actions">
          <button class="action-btn action-btn--danger" data-action="close-mm" type="button">Close (Esc)</button>
        </div>
      </div>
    </section>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

    const toastEl = $("#toast");
    function toast(msg) {
      toastEl.textContent = msg;
      toastEl.classList.add("is-on");
      window.clearTimeout(toastEl._t);
      toastEl._t = window.setTimeout(() => toastEl.classList.remove("is-on"), 1400);
    }

    function seed() {
      const s = crypto?.getRandomValues ? crypto.getRandomValues(new Uint8Array(16)) : null;
      if (!s) return "d869db7f-e62f-b07c-25a0-403e-caea5503";
      return Array.from(s).map((b) => b.toString(16).padStart(2, "0")).join("");
    }
    $("#seed").textContent = seed();
    $("#year").textContent = new Date().getFullYear();

    let LINKS = {
      linkedin: "https://www.linkedin.com",
      github: "https://github.com/caesar-dat-com",
    };
    const EMAIL = "cesar.cesarreyes25@gmail.com";

    // DANE (hombres) ~ 74,48 a√±os. (usado como estimaci√≥n para el Memento Mori)
    const LIFE_EXPECTANCY_YEARS_CO_MALE = 74.48;

    const BIRTH = new Date(2000, 0, 25, 0, 0, 0, 0); // 25 Jan 2000

    // ===== LinkedIn JSON fallback =====
    const defaultSummary =
      "Enfocado en automatizaci√≥n, datos e IA, construyo sistemas √∫tiles, medibles y trazables en entornos reales.";

    const fallback = {
      firstName: "C√©sar",
      lastName: "Reyes",
      headline: "Data ¬∑ IA ¬∑ Automatizaci√≥n",
      location: "Colombia",
      publicProfileUrl: LINKS.linkedin,
      summary: defaultSummary,
      skills: [
        { name: "Python" },
        { name: "Power BI" },
        { name: "DAX" },
        { name: "Excel" },
        { name: "Git" },
        { name: "HTML/CSS" },
      ],
      certifications: [],
    };

    let allSkills = [];
    let allCerts = [];

    async function loadLinkedIn() {
      try {
        const res = await fetch("linkedin-data.json", { cache: "no-store" });
        if (!res.ok) throw new Error("No se pudo cargar linkedin-data.json");
        const data = await res.json();
        return { ...fallback, ...data };
      } catch (e) {
        console.warn("LinkedIn JSON fallback:", e);
        return fallback;
      }
    }

    function renderSkills(list, query = "") {
      const ul = $("#skills");
      const empty = $("#skills-empty");
      if (!ul) return;
      ul.innerHTML = "";

      const q = query.trim().toLowerCase();
      const filtered = !q ? list : list.filter((s) => (s?.name || "").toLowerCase().includes(q));

      if (!filtered.length) {
        empty.style.display = "block";
        return;
      }
      empty.style.display = "none";

      filtered.slice(0, 90).forEach((skill) => {
        const li = document.createElement("li");
        li.className = "chip";
        li.textContent = skill.name;
        ul.appendChild(li);
      });
    }

    function renderCerts(list, query = "") {
      const ul = $("#certifications");
      const empty = $("#certs-empty");
      if (!ul) return;
      ul.innerHTML = "";

      const q = query.trim().toLowerCase();
      const filtered = !q
        ? list
        : list.filter((c) => {
          const n = (c?.name || "").toLowerCase();
          const a = (c?.authority || "").toLowerCase();
          return n.includes(q) || a.includes(q);
        });

      if (!filtered.length) {
        empty.style.display = "block";
        return;
      }
      empty.style.display = "none";

      filtered.slice(0, 60).forEach((cert) => {
        const li = document.createElement("li");
        const startDate = cert.timePeriod?.startDate
          ? `${cert.timePeriod.startDate.month}/${cert.timePeriod.startDate.year}`
          : "N/A";
        const endDate = cert.timePeriod?.endDate
          ? `${cert.timePeriod.endDate.month}/${cert.timePeriod.endDate.year}`
          : "En curso";

        const name = cert.name || "Certificaci√≥n";
        const authority = cert.authority || "N/A";

        li.innerHTML = `
            <div style="margin-bottom:10px;">
              <strong style="color: var(--colors-secondary--500)">${name}</strong><br/>
              <span style="opacity:.92;">Autoridad: ${authority}</span><br/>
              <span style="opacity:.92;">Inicio: ${startDate} ¬∑ Fin: ${endDate}</span>
            </div>
          `;
        ul.appendChild(li);
      });
    }

    // ===== Router (solo una secci√≥n visible) =====
    const stage = $("#stage");
    const pages = $$("[data-page]");
    const railButtons = $$("#rail button");

    const sectionMeta = {
      about: "Qui√©n soy y enfoque actual.",
      stack: "Skills y herramientas. El filtro aplica aqu√≠.",
      experience: "Rol actual y trayectoria en planta.",
      projects: "Construcci√≥n de soluciones √∫tiles y medibles.",
      education: "Formaci√≥n base + especializaci√≥n.",
      certs: "Certificaciones y cursos.",
      contact: "Contacto r√°pido v√≠a Actions (U).",
    };

    function setRailActive(id) {
      railButtons.forEach((b) => b.classList.toggle("is-active", b.dataset.go === id));
    }

    function setSnapshot(id) {
      const names = {
        about: "Sobre m√≠",
        stack: "Stack",
        experience: "Experiencia",
        projects: "Proyectos",
        education: "Educaci√≥n",
        certs: "Certificaciones",
        contact: "Contacto",
      };
      $("#current-section").textContent = names[id] || "‚Äî";
      $("#snapshot").textContent = sectionMeta[id] || "Vista r√°pida.";
    }

    function showGlitchPulse() {
      stage.classList.add("is-glitch");
      window.clearTimeout(stage._g);
      stage._g = window.setTimeout(() => stage.classList.remove("is-glitch"), 460);
    }

    function navigate(id, { pushHash = true } = {}) {
      const target = document.getElementById(id);
      if (!target) return;

      const current = pages.find((p) => p.classList.contains("is-active"));
      if (current && current.id === id) return;

      const run = () => {
        if (current) current.classList.remove("is-active");
        target.classList.add("is-active");
        setRailActive(id);
        setSnapshot(id);
        stage.scrollTop = 0; // UX app
      };

      showGlitchPulse();
      if (document.startViewTransition) document.startViewTransition(run);
      else run();

      if (pushHash) history.replaceState(null, "", `#${id}`);
    }

    railButtons.forEach((b) => b.addEventListener("click", () => navigate(b.dataset.go)));

    // ===== Actions popover =====
    const popActions = $("#actions");
    $("#actions").addEventListener("click", async (e) => {
      const btn = e.target.closest("button[data-action]");
      if (!btn) return;
      const act = btn.dataset.action;

      if (act === "linkedin") window.open(LINKS.linkedin, "_blank", "noreferrer");
      if (act === "github") window.open(LINKS.github, "_blank", "noreferrer");
      if (act === "copy") {
        try {
          await navigator.clipboard.writeText(EMAIL);
          toast("EMAIL COPIADO");
        } catch {
          toast("NO SE PUDO COPIAR");
        }
      }
      if (act === "close") popActions.hidePopover();
    });

    // ===== Memento Mori =====
    const popMemento = $("#memento");
    $("#memento").addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-action]");
      if (!btn) return;
      if (btn.dataset.action === "close-mm") popMemento.hidePopover();
    });

    function msToParts(ms) {
      const s = Math.max(0, Math.floor(ms / 1000));
      const days = Math.floor(s / 86400);
      const hours = Math.floor((s % 86400) / 3600);
      const mins = Math.floor((s % 3600) / 60);
      const secs = s % 60;
      return { days, hours, mins, secs };
    }

    function fmtDHMS({ days, hours, mins, secs }) {
      const hh = String(hours).padStart(2, "0");
      const mm = String(mins).padStart(2, "0");
      const ss = String(secs).padStart(2, "0");
      return days > 0 ? `${days}d ${hh}:${mm}:${ss}` : `${hh}:${mm}:${ss}`;
    }

    function endOfDay(now) {
      const d = new Date(now);
      d.setHours(23, 59, 59, 999);
      return d;
    }

    // Semana: termina Domingo 23:59:59 local
    function endOfWeek(now) {
      const d = new Date(now);
      const day = d.getDay(); // 0=Dom
      const daysToSunday = (7 - 1 - day + 7) % 7; // si hoy es domingo -> 0
      const eod = endOfDay(d);
      eod.setDate(eod.getDate() + daysToSunday);
      return eod;
    }

    function lifeEndDate() {
      const days = LIFE_EXPECTANCY_YEARS_CO_MALE * 365.2425;
      return new Date(BIRTH.getTime() + days * 86400000);
    }

    function weeksTotals() {
      const totalDays = LIFE_EXPECTANCY_YEARS_CO_MALE * 365.2425;
      const totalWeeks = Math.round(totalDays / 7);
      return totalWeeks;
    }

    function calcWeeks(now) {
      const totalWeeks = weeksTotals();
      const livedWeeks = Math.max(0, Math.floor((now - BIRTH) / 604800000));
      const leftWeeks = Math.max(0, totalWeeks - livedWeeks);
      const currentWeekIndex = Math.min(totalWeeks - 1, livedWeeks); // ‚Äúsemana actual‚Äù
      return { totalWeeks, livedWeeks, leftWeeks, currentWeekIndex };
    }

    function drawMementoGrid(now) {
      const c = $("#mm-canvas");
      if (!c) return;

      const ctx = c.getContext("2d");
      const dpr = Math.max(1, window.devicePixelRatio || 1);

      // Fit to element size (responsive-ish)
      const cssW = c.clientWidth || c.width;
      const cssH = c.clientHeight || c.height;

      c.width = Math.floor(cssW * dpr);
      c.height = Math.floor(cssH * dpr);
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

      const { totalWeeks, livedWeeks, currentWeekIndex } = calcWeeks(now);

      const cols = 52; // ‚Äúcalendario‚Äù por semanas/a√±o
      const rows = Math.ceil(totalWeeks / cols);

      const pad = 6;
      const w = cssW - pad * 2;
      const h = cssH - pad * 2;

      const gap = 1;
      const cellW = Math.floor((w - gap * (cols - 1)) / cols);
      const cellH = Math.floor((h - gap * (rows - 1)) / rows);
      const cell = Math.max(1, Math.min(cellW, cellH)); // cuadrado

      const gridW = cols * cell + gap * (cols - 1);
      const gridH = rows * cell + gap * (rows - 1);

      const ox = Math.floor((cssW - gridW) / 2);
      const oy = Math.floor((cssH - gridH) / 2);

      const styles = getComputedStyle(document.documentElement);
      const livedColor = styles.getPropertyValue("--accent").trim() || "#2be4ea";
      const leftColor = "rgba(255,255,255,0.12)";
      const nowColor = styles.getPropertyValue("--colors-tertiary--500").trim() || "#fed33f";

      ctx.clearRect(0, 0, cssW, cssH);

      for (let i = 0; i < totalWeeks; i++) {
        const r = Math.floor(i / cols);
        const col = i % cols;
        const x = ox + col * (cell + gap);
        const y = oy + r * (cell + gap);

        const isLived = i < livedWeeks;
        const isNow = i === currentWeekIndex;

        ctx.fillStyle = isNow ? nowColor : isLived ? livedColor : leftColor;
        ctx.fillRect(x, y, cell, cell);
      }
    }

    function updateMemento(now = new Date()) {
      const { totalWeeks, livedWeeks, leftWeeks } = calcWeeks(now);

      $("#mm-sub").textContent = `Nacido: 25/01/2000 ¬∑ Total: ${totalWeeks} semanas`;
      $("#mm-lived").textContent = `${livedWeeks}`;
      $("#mm-left").textContent = `${leftWeeks}`;

      $("#mm-lived-2").textContent = `${livedWeeks}`;
      $("#mm-left-2").textContent = `${leftWeeks}`;
      $("#mm-total-2").textContent = `${totalWeeks}`;

      drawMementoGrid(now);

      const eod = endOfDay(now);
      const eow = endOfWeek(now);
      const eol = lifeEndDate();

      $("#t-day").textContent = fmtDHMS(msToParts(eod - now));
      $("#t-week").textContent = fmtDHMS(msToParts(eow - now));

      const lifeMs = eol - now;
      const lifeParts = msToParts(lifeMs);
      // Para ‚Äúvida‚Äù, muestro en d√≠as + hh:mm:ss (m√°s estable)
      $("#t-life").textContent =
        lifeMs <= 0 ? "00:00:00" : `${lifeParts.days}d ${String(lifeParts.hours).padStart(2, "0")}:${String(lifeParts.mins).padStart(2, "0")}:${String(lifeParts.secs).padStart(2, "0")}`;

      $("#life-date").textContent =
        `Fecha estimada: ${eol.toLocaleString("es-CO", { year: "numeric", month: "long", day: "numeric" })} ¬∑ (Usando ${LIFE_EXPECTANCY_YEARS_CO_MALE} a√±os)`;
    }

    // Keyboard shortcuts
    window.addEventListener("keydown", (e) => {
      const map = {
        "1": "about",
        "2": "stack",
        "3": "experience",
        "4": "projects",
        "5": "education",
        "6": "certs",
        "7": "contact",
      };

      if (map[e.key]) navigate(map[e.key]);

      if (e.key === "u" || e.key === "U") {
        const pop = $("#actions");
        pop.matches(":popover-open") ? pop.hidePopover() : pop.showPopover();
      }

      if (e.key === "m" || e.key === "M") {
        const pop = $("#memento");
        pop.matches(":popover-open") ? pop.hidePopover() : pop.showPopover();
      }

      if (e.key === "/") {
        e.preventDefault();
        $("#search").focus();
      }

      if (e.key === "Escape") {
        if (popActions.matches(":popover-open")) popActions.hidePopover();
        if (popMemento.matches(":popover-open")) popMemento.hidePopover();
      }
    });

    // Search filter
    $("#search").addEventListener("input", (e) => {
      const q = e.target.value || "";
      renderSkills(allSkills, q);
      renderCerts(allCerts, q);
    });

    // Init
    (async function init() {
      const data = await loadLinkedIn();

      $("#name").textContent = `${data.firstName || ""} ${data.lastName || ""}`.trim() || "C√©sar Reyes";
      $("#headline").textContent = (data.headline || "Data ¬∑ IA ¬∑ Automatizaci√≥n").replace(/junior/gi, "").trim();
      $("#location").textContent = data.location || "Colombia";

      const summary = (data.summary || "").trim();
      $("#summary").textContent = summary || defaultSummary;

      if (data.publicProfileUrl) LINKS.linkedin = data.publicProfileUrl;

      allSkills = (data.skills || []).map((s) => ({ name: s.name || "" })).filter((s) => s.name);
      allCerts = (data.certifications || []).filter(Boolean);

      renderSkills(allSkills);
      renderCerts(allCerts);

      const start = (location.hash || "#about").replace("#", "");
      navigate(start, { pushHash: false });

      updateMemento(new Date());
      setInterval(() => updateMemento(new Date()), 1000);
    })();
  </script>
</body>

</html>